<html lang="ja">
<head>
  <meta charset="utf-8">
  <style>
      canvas {
        background: url(./images/back.png) !important;
      }
  </style>
  <script src="pathseg.js"></script>
  <script src="decomp.min.js"></script>
  <script src="matter.min.js"></script>
  <script>
    window.onload = function () {
      var Engine = Matter.Engine,
         World = Matter.World,
         Body = Matter.Body,
         Bodies = Matter.Bodies,
         Constraint = Matter.Constraint,
         Composites = Matter.Composites,
         Common = Matter.Common,
         Vertices = Matter.Vertices,
         MouseConstraint = Matter.MouseConstraint,
         Svg = Matter.Svg;

      // Engine作成
      var container = document.getElementById("container");
      var engine = Engine.create(container, {
        render: { //レンダリング設定
          options: {
            wireframes: false,
            width: 1280,
            height: 720
          }
        }
      });

      // マウス操作
      var mouseConstraint = MouseConstraint.create(engine);
      World.add(engine.world, mouseConstraint);

      var pathelement = document.createElementNS("http://www.w3.org/2000/svg", "path");
      pathelement.setAttribute("d", "M20,42L12,40L0,32L0,128L128,128L128,86L120,82L112,76L96,68L88,66L80,62L72,64L48,56L32,48L28,46Z");
      var options = {
        isStatic: true,
        friction: 0,
        render: { //レンダリング設定
          fillStyle: "#1b8d1b",
          strokeStyle: "#1b8d1b"
        }
      };
      var numa = Bodies.fromVertices(
        350,
        410,
        Svg.pathToVertices(pathelement),
        options
      );
      Body.scale(numa, 8, 8);
      World.add(engine.world, numa);

      //物体追加
      var texlist = ['GodTanu.png', 'newcoin_jp.png', 'hakase_jiisan.png', 'HowDoYouLikeU.png', 'itumo_nem.png', 'haru28bit.png', 'TrendStream.png', 'Bungaku_Crypto.png', 'dreamcanada.png', 'tomotomo_9696.png', 'gon61811.png', 'him0net.png', 'mizunashi.png'];
      for (var i = 0; i < texlist.length; i++) {
        var rnd = parseInt(Math.random() * 32);
        var x = 320 + rnd * 10;
        var y = -(i * 320);
        World.add(engine.world, [
                    Bodies.circle(x, y, 60, { //追加
                      density: 0.002, //密度 default:0.001
                      friction: 0.1, //摩擦 default:0.1
                      frictionAir: 0.012, //空気摩擦 default:0.01
                      restitution: 0.3, // 弾力性 default:0
                      render: { //レンダリング設定
                        sprite: { //スプライト設定
                          texture: `images/${texlist[i]}`, //テクスチャ画像を指定
                        }
                      },
                      collisionFilter: {
                        mask: 0x0001
                      }
                    })
        ]);
      }
      World.add(engine.world, [
        Bodies.rectangle(640, 640, 1280, 160, {
          isStatic: true,
          collisionFilter: {
            category: 0x0002
          },
          render: {
            fillStyle: "rgba(180, 153, 129, 0.8)",
            strokeStyle: "rgb(180, 153, 129)"
          }
        })
      ]);

      //実行
      Engine.run(engine);
    };
  </script>
</head>
<body>
  <div id="container"></div>
  <div>
    <iframe width="300" height="80" src="https://www.youtube.com/embed/JhTqZApeYmc?autoplay=1&rel=0&autohide=0&start=23" frameborder="0"></iframe>
    <ul>
      <li>先住民なので追加してほしい</li>
      <li>沼に飛び込みたい</li>
      <li>沼に浸かる予定がある</li>
    </ul>
    <p>等の方は twitter <a href="https://twitter.com/tomotomo_9696">@tomotomo_9696</a> に知らせると追加されます。(指定がない場合twitterアイコンを使いますので、他の画像がいい場合は言ってください)</p>
    <p><a href="https://github.com/tomotomo9696/numa">Github</a></p>
  </div>
</body>
</html>
